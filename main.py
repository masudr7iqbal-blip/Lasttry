# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#                  à¦•à¦¨à¦«à¦¿à¦—à¦¾à¦°à§‡à¦¶à¦¨
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

API_TOKEN = '8530900754:AAFiFRX60Om1r485mTSdiEs37rvvjz78NbI'

CHANNELS = [
    '-1003708243060',
    '-1003831376808',
    # à¦†à¦°à¦“ à¦šà§à¦¯à¦¾à¦¨à§‡à¦² ID à¦¯à§‹à¦— à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à§‹
]

CHANNEL_LINKS = [
    'https://t.me/+cv_IIV016XljNDMx',
    'https://t.me/+n46o9tlogDVhMDMx',
    'https://t.me/+YlNW7n3rYsE4M2Mx',
]

ADMIN_USERNAME = "XpremiumB"          # t.me/XpremiumB
ADMIN_ID = 8153774922                 # à¦¤à§‹à¦®à¦¾à¦° à¦†à¦¸à¦² à¦Ÿà§‡à¦²à¦¿à¦—à§à¦°à¦¾à¦® à¦†à¦‡à¦¡à¦¿

STORAGE_BOT_URL = "https://t.me/AlphaStorageBot?start=demo123"
BOT_USERNAME = "AlphapremiumB_bot"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#               à¦ªà§à¦°à¦¿à¦®à¦¿à§Ÿà¦¾à¦® + à¦à¦•à§à¦¸à¦•à§à¦²à§à¦¸à¦¿à¦­ à¦Ÿà§‡à¦•à§à¦¸à¦Ÿ
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

WELCOME_TEXT = (
    "ğŸŒŸ **WELCOME TO THE INNER CIRCLE** ğŸŒŸ\n\n"
    "à¦¹à§à¦¯à¦¾à¦²à§‹ {name} â€”\n"
    "à¦¤à§à¦®à¦¿ à¦à¦–à¦¨ à¦¶à§à¦§à§à¦®à¦¾à¦¤à§à¦° **à¦¸à¦¿à¦²à§‡à¦•à§à¦Ÿà§‡à¦¡ à¦«à¦¿à¦‰** à¦à¦° à¦œà¦¨à§à¦¯ à¦°à¦¾à¦–à¦¾ à¦à¦•à§à¦¸à¦•à§à¦²à§à¦¸à¦¿à¦­ à¦œà§‹à¦¨à§‡à¦° à¦­à§‡à¦¤à¦°à§‡ à¦¢à§à¦•à§‡ à¦ªà§œà§‡à¦›à¥¤\n\n"
    "à¦à¦–à¦¾à¦¨ à¦¥à§‡à¦•à§‡ à¦¶à§à¦°à§ à¦•à¦°à§‹ â†“"
)

FORCE_JOIN_TEXT = (
    "ğŸ” **VIP ACCESS LOCKED** ğŸ”\n\n"
    "à¦à¦‡ à¦à¦•à§à¦¸à¦•à§à¦²à§à¦¸à¦¿à¦­ à¦•à¦¨à¦Ÿà§‡à¦¨à§à¦Ÿ à¦¶à§à¦§à§à¦®à¦¾à¦¤à§à¦° à¦†à¦®à¦¾à¦¦à§‡à¦° **à¦ªà§à¦°à¦¾à¦‡à¦­à§‡à¦Ÿ à¦¸à¦¾à¦°à§à¦•à§‡à¦²**-à¦à¦° à¦®à§‡à¦®à§à¦¬à¦¾à¦°à¦¦à§‡à¦° à¦œà¦¨à§à¦¯à¥¤\n"
    "à¦¨à¦¿à¦šà§‡à¦° à¦šà§à¦¯à¦¾à¦¨à§‡à¦²à¦—à§à¦²à§‹à¦¤à§‡ à¦œà§Ÿà§‡à¦¨ à¦•à¦°à§‡ **à¦†à¦¨à¦²à¦•** à¦•à¦°à§‹à¥¤\n\n"
    "à¦œà§Ÿà§‡à¦¨ à¦¶à§‡à¦· à¦¹à¦²à§‡ â†’ **I'm Ready âœ…** à¦šà¦¾à¦ªà§‹ â€” à¦…à¦Ÿà§‹ à¦­à¦¿à¦¤à¦°à§‡ à¦šà¦²à§‡ à¦†à¦¸à¦¬à§‡!"
)

PREMIUM_TEXT = (
    "âœ¦ **ELITE MEMBERSHIP** âœ¦\n\n"
    "â€¢ Zero Ads | Pure Experience\n"
    "â€¢ Lightning Fast Downloads\n"
    "â€¢ Unlimited Premium Files\n"
    "â€¢ Early Access to New Drops\n"
    "â€¢ Private Support Line\n\n"
    "à¦à¦‡ à¦²à§‡à¦­à§‡à¦²à§‡à¦° à¦à¦•à§à¦¸à§‡à¦¸ à¦šà¦¾à¦“? â†’ à¦à¦¡à¦®à¦¿à¦¨à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦•à¦¥à¦¾ à¦¬à¦²à§‹"
)

HELP_TEXT = (
    "ğŸ›  **à¦•à¦®à¦¾à¦¨à§à¦¡ à¦²à¦¿à¦¸à§à¦Ÿ** ğŸ› \n\n"
    "/start  â†’  à¦®à§‚à¦² à¦®à§‡à¦¨à§ + à¦à¦•à§à¦¸à§‡à¦¸ à¦šà§‡à¦•\n"
    "/help   â†’  à¦à¦‡ à¦®à§‡à¦¸à§‡à¦œà¦Ÿà¦¾ à¦¦à§‡à¦–à¦¾à¦¬à§‡\n\n"
    "ğŸ’ à¦ªà§à¦°à¦¿à¦®à¦¿à§Ÿà¦¾à¦® à¦«à¦¿à¦šà¦¾à¦° à¦šà¦¾à¦“?\n"
    "â†’ /start à¦šà¦¾à¦²à¦¿à§Ÿà§‡ **à¦ªà§à¦°à¦¿à¦®à¦¿à§Ÿà¦¾à¦® à¦•à¦¿à¦¨à§à¦¨** à¦¬à¦¾à¦Ÿà¦¨à§‡ à¦•à§à¦²à¦¿à¦• à¦•à¦°à§‹\n\n"
    "à¦•à§‹à¦¨à§‹ à¦¸à¦®à¦¸à§à¦¯à¦¾ à¦¹à¦²à§‡ â†’ @{admin}\n"
    "Enjoy the exclusive zone ğŸ”¥"
)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

bot = telebot.TeleBot(API_TOKEN, threaded=False)

# Flask server to keep Render alive
app = Flask('')

@app.route('/')
def home():
    return "Telegram Bot is alive âœ“"

def run_flask():
    app.run(host='0.0.0.0', port=8080)

def keep_alive():
    Thread(target=run_flask, daemon=True).start()

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#             à¦«à§‹à¦°à§à¦¸ à¦œà§Ÿà§‡à¦¨ à¦šà§‡à¦•
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

def is_user_subscribed(user_id: int) -> bool:
    for channel_id in CHANNELS:
        try:
            member = bot.get_chat_member(channel_id, user_id)
            if member.status not in ['member', 'administrator', 'creator', 'restricted']:
                return False
        except Exception as e:
            print(f"à¦šà§à¦¯à¦¾à¦¨à§‡à¦² à¦šà§‡à¦• à¦¤à§à¦°à§à¦Ÿà¦¿ {channel_id}: {e}")
            return False
    return True

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#               à¦¹à§à¦¯à¦¾à¦¨à§à¦¡à¦²à¦¾à¦°
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

@bot.message_handler(commands=['start'])
def cmd_start(message):
    user = message.from_user
    name = user.first_name or "à¦¬à¦¨à§à¦§à§"

    if is_user_subscribed(user.id):
        markup = types.InlineKeyboardMarkup(row_width=1)
        markup.add(
            types.InlineKeyboardButton("âœ¨ Unlock Demo Vault", url=STORAGE_BOT_URL),
            types.InlineKeyboardButton("ğŸ‘‘ Claim Elite Access", callback_data="premium")
        )
        bot.send_message(
            message.chat.id,
            WELCOME_TEXT.format(name=name),
            reply_markup=markup,
            parse_mode="Markdown"
        )
    else:
        markup = types.InlineKeyboardMarkup(row_width=1)
        for i, link in enumerate(CHANNEL_LINKS, 1):
            markup.add(types.InlineKeyboardButton(f"âœ¦ Join Private Channel {i} âœ¦", url=link))
        
        markup.add(types.InlineKeyboardButton("I'm Ready âœ… | Unlock Now", callback_data="check_join"))
        
        bot.send_message(
            message.chat.id,
            FORCE_JOIN_TEXT,
            reply_markup=markup,
            parse_mode="Markdown",
            disable_web_page_preview=True
        )

@bot.message_handler(commands=['help'])
def cmd_help(message):
    bot.send_message(
        message.chat.id,
        HELP_TEXT.format(admin=ADMIN_USERNAME),
        parse_mode="Markdown"
    )

@bot.callback_query_handler(func=lambda call: True)
def callback_handler(call):
    user_id = call.from_user.id

    if call.data == "check_join":
        if is_user_subscribed(user_id):
            bot.answer_callback_query(call.id, "ğŸ‰ à¦†à¦¨à¦²à¦• à¦¸à¦¾à¦•à¦¸à§‡à¦¸! à¦­à¦¿à¦¤à¦°à§‡ à¦šà¦²à§‹ ğŸ”¥", show_alert=False)
            
            name = call.from_user.first_name or "à¦¬à¦¨à§à¦§à§"
            markup = types.InlineKeyboardMarkup(row_width=1)
            markup.add(
                types.InlineKeyboardButton("âœ¨ Unlock Demo Vault", url=STORAGE_BOT_URL),
                types.InlineKeyboardButton("ğŸ‘‘ Claim Elite Access", callback_data="premium")
            )
            # à¦ªà§à¦°à§‹à¦¨à§‹ à¦®à§‡à¦¸à§‡à¦œ à¦à¦¡à¦¿à¦Ÿ à¦•à¦°à§‡ à¦“à§Ÿà§‡à¦²à¦•à¦¾à¦® à¦¦à§‡à¦–à¦¾à¦¨à§‹ (à¦•à§à¦²à¦¿à¦¨ à¦…à¦­à¦¿à¦œà§à¦à¦¤à¦¾)
            try:
                bot.edit_message_text(
                    chat_id=call.message.chat.id,
                    message_id=call.message.message_id,
                    text=WELCOME_TEXT.format(name=name),
                    reply_markup=markup,
                    parse_mode="Markdown"
                )
            except:
                # à¦¯à¦¦à¦¿ à¦à¦¡à¦¿à¦Ÿ à¦¨à¦¾ à¦¹à§Ÿ (à¦ªà§à¦°à§‹à¦¨à§‹ à¦®à§‡à¦¸à§‡à¦œ à¦¡à¦¿à¦²à¦¿à¦Ÿ à¦¹à§Ÿà§‡ à¦—à§‡à¦²à§‡)
                bot.send_message(
                    call.message.chat.id,
                    WELCOME_TEXT.format(name=name),
                    reply_markup=markup,
                    parse_mode="Markdown"
                )
        else:
            bot.answer_callback_query(
                call.id,
                "à¦†à¦ªà¦¨à¦¿ à¦à¦–à¦¨à§‹ à¦¸à¦¬ à¦šà§à¦¯à¦¾à¦¨à§‡à¦²à§‡ à¦œà§Ÿà§‡à¦¨ à¦•à¦°à§‡à¦¨à¦¨à¦¿ ğŸ˜•\nà¦¦à§Ÿà¦¾ à¦•à¦°à§‡ à¦šà§‡à¦• à¦•à¦°à§à¦¨!",
                show_alert=True
            )

    elif call.data == "premium":
        markup = types.InlineKeyboardMarkup(row_width=1)
        markup.add(
            types.InlineKeyboardButton("ğŸ‘‘ Talk to Elite Manager", url=f"https://t.me/{ADMIN_USERNAME}")
        )
        bot.send_message(
            call.message.chat.id,
            PREMIUM_TEXT,
            reply_markup=markup,
            parse_mode="Markdown"
        )
        bot.answer_callback_query(call.id)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

if __name__ == "__main__":
    keep_alive()
    print("Bot starting with updated design...")
    try:
        bot.infinity_polling(timeout=15, long_polling_timeout=10)
    except Exception as e:
        print(f"Polling stopped â†’ {e}")
